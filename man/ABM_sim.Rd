% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ABM_sim.R
\name{ABM_sim}
\alias{ABM_sim}
\title{Run Agent-Based Model Simulation for Animal Movement}
\usage{
ABM_sim(study_design, lscape_defs, animalxy.0 = NULL)
}
\arguments{
\item{study_design}{A list containing the simulation parameters. Must include:
\itemize{
\item \code{dx}, \code{dy}: Dimensions of grid cells (numeric).
\item \code{q}: Total number of grid cells (numeric). Assumes a square grid where sqrt(q) is an integer.
\item \code{t_steps}: Number of time steps to simulate (integer).
\item \code{group_sizes}: Vector of integers defining the size of each animal group.
\item \code{group_spread}: Initial spatial spread of groups (numeric).
\item \code{dt}: Time increment per step (numeric).
\item \code{bounds}: Vector defining the spatial extent (e.g., \code{c(min, max)}).
}}

\item{lscape_defs}{A data frame defining the landscape properties. Must include:
\itemize{
\item \code{Value}: Base movement speeds associated with landscape cells.
\item \code{Speed}: (Optional) Speed category labels used for the final output.
}}

\item{animalxy.0}{(Optional) A data frame of initial animal positions. If \code{NULL} (default),
positions are generated using internal helper functions \code{place_animals}
and \code{create_activity_mat}.}
}
\value{
A data frame (tibble) containing the complete simulation trajectory with columns:
\itemize{
\item \code{Animal_ID}: Unique identifier for the animal.
\item \code{group_ID}: Identifier for the group.
\item \code{X}, \code{Y}: Spatial coordinates.
\item \code{t}: Time stamp.
\item \code{lscape_index}: Index of the grid cell the animal is currently in.
\item \code{trav_dist}: Distance traveled from the previous step.
\item \code{trav_speeds}: Calculated speed for the step.
\item \code{lscape_type}: The speed category of the current landscape cell.
}
}
\description{
Simulates animal movement across a heterogeneous landscape using a parallelized
agent-based model (ABM). Animals move in groups based on correlated random walks
(CRW), adjusting their speed and direction based on landscape features and
boundary interactions.
}
\details{
The simulation utilizes parallel processing (defaulting to 3 cores) to iterate
through animal groups. Movement directions are determined using a Von Mises
distribution (\code{Rfast::rvonmises}). If an animal crosses a grid cell boundary
into a new landscape type, its speed is adjusted using a truncated normal
distribution based on the new cell's friction/speed value.

Boundary conditions are reflective: if an animal hits the simulation bounds,
it reflects back into the simulation area.
}
