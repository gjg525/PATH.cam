% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MCMC_functions.R
\name{fit.model.mcmc.PATH}
\alias{fit.model.mcmc.PATH}
\title{Fit Landscape Density Model using MCMC}
\usage{
fit.model.mcmc.PATH(
  study_design,
  cam_design,
  cam_locs,
  gamma_start,
  gamma_prior_var = 10^4,
  gamma_tune,
  kappa_start,
  kappa_prior_mu,
  kappa_prior_var,
  kappa_tune,
  count_data_in,
  habitat_summary,
  grouping = "Speed"
)
}
\arguments{
\item{study_design}{A list of simulation/study parameters. Must include:
\itemize{
\item \code{n_iter}: Number of MCMC iterations.
\item \code{dx}, \code{dy}: Grid cell dimensions.
\item \code{t_steps}: Number of time steps.
\item \code{covariate_labels}: Names of the covariates (e.g., speed categories).
\item \code{num_covariates}: Integer count of covariates.
\item \code{Z}: Covariate design matrix.
\item \code{q}: Total number of grid cells.
}}

\item{cam_design}{A list containing camera design details, specifically
\code{cam_A} (area of camera view).}

\item{cam_locs}{A data frame of camera locations (passed but not currently used
in the calculation logic provided).}

\item{gamma_start}{Vector of initial values for density coefficients.}

\item{gamma_prior_var}{Numeric, variance for the Normal prior on gamma.}

\item{gamma_tune}{Vector of initial tuning variances for gamma proposals.}

\item{kappa_start}{Vector of initial values for staying time coefficients.}

\item{kappa_prior_mu}{Vector of means for the Normal prior on kappa.}

\item{kappa_prior_var}{Numeric, variance for the Normal prior on kappa.}

\item{kappa_tune}{Vector of initial tuning variances for kappa proposals.}

\item{count_data_in}{A data frame containing observed counts.
\strong{Crucial:} If \code{grouping = "Speed"}, this must contain a column named "Speed".
If \code{grouping} is anything else, it must contain a column named "Road".}

\item{habitat_summary}{A list/data frame containing landscape summaries:
\itemize{
\item \code{n_lscape}: Count of cells per landscape type.
\item \code{prop_cams}: Proportion of cameras in each landscape type.
}}

\item{grouping}{Character string (default "Speed"). determines which column
in \code{count_data_in} is used to subset counts.}
}
\value{
A list containing MCMC chains and diagnostics:
\itemize{
\item \code{accept}: Matrix of acceptance (1/0) events for diagnostics.
\item \code{gamma}: Matrix of posterior samples for density coefficients.
\item \code{kappa}: Matrix of posterior samples for staying time coefficients.
\item \code{tot_u}: Vector of estimated total abundance/density across iterations.
}
}
\description{
Implements a custom Adaptive Metropolis-Hastings MCMC algorithm to estimate
landscape-dependent density parameters (\code{gamma}) and staying time proportions
(\code{kappa}). The model integrates camera trap counts with landscape covariates
to estimate total abundance (\code{tot_u}).
}
\details{
The function estimates parameters using a Poisson likelihood for camera counts
and Normal priors for coefficients. It employs an adaptive tuning mechanism
where proposal variances (\code{gamma_tune}, \code{kappa_tune}) are adjusted every 100
iterations to target an acceptance rate of approximately 44\%.

The model assumes:
\itemize{
\item \code{d = exp(gamma)}: Density intensity per landscape type.
\item \code{stay_prop = exp(kappa)}: Proportional staying time.
}
}
